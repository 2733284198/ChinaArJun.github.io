<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>阿俊博客|记录一个程序员的成长历程</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?51b8c2e72d1adf96524638ce85bb7d72";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);

            // 引入谷歌,不需要可删除这段
            var hm1 = document.createElement("script");
            hm1.src = "https://www.googletagmanager.com/gtag/js?id=G-B7351EYS04";
            var s1 = document.getElementsByTagName("script")[0]; 
            s1.parentNode.insertBefore(hm1, s1);
            })();

            // 谷歌加载,不需要可删除
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-B7351EYS04');
        </script>
    <meta name="description" content="阿俊博客(blog.zhequtao.com)记录一个后端程序员的成长历程,分享他的学习笔记和心得,还有些开发必备技巧哦! java golang web html dev开发">
    <link rel="preload" href="/assets/css/0.styles.a3df589e.css" as="style"><link rel="preload" href="/assets/js/app.9ea962d1.js" as="script"><link rel="preload" href="/assets/js/2.c9a70b15.js" as="script"><link rel="preload" href="/assets/js/4.844b86fa.js" as="script"><link rel="preload" href="/assets/js/313.6d0015fd.js" as="script"><link rel="prefetch" href="/assets/js/10.62e601c1.js"><link rel="prefetch" href="/assets/js/100.cf1207c5.js"><link rel="prefetch" href="/assets/js/101.4d7a9918.js"><link rel="prefetch" href="/assets/js/102.fc6db33a.js"><link rel="prefetch" href="/assets/js/103.30b8eabe.js"><link rel="prefetch" href="/assets/js/104.820bf0b0.js"><link rel="prefetch" href="/assets/js/105.99743e1b.js"><link rel="prefetch" href="/assets/js/106.0ab60d54.js"><link rel="prefetch" href="/assets/js/107.622d7433.js"><link rel="prefetch" href="/assets/js/108.aa7661f4.js"><link rel="prefetch" href="/assets/js/109.c0895a64.js"><link rel="prefetch" href="/assets/js/11.7da91838.js"><link rel="prefetch" href="/assets/js/110.c81dd090.js"><link rel="prefetch" href="/assets/js/111.24ece24d.js"><link rel="prefetch" href="/assets/js/112.30f8c029.js"><link rel="prefetch" href="/assets/js/113.eaaeb7ca.js"><link rel="prefetch" href="/assets/js/114.ba155e36.js"><link rel="prefetch" href="/assets/js/115.d6dc863f.js"><link rel="prefetch" href="/assets/js/116.88505488.js"><link rel="prefetch" href="/assets/js/117.b5d01796.js"><link rel="prefetch" href="/assets/js/118.67d3a13c.js"><link rel="prefetch" href="/assets/js/119.86770a17.js"><link rel="prefetch" href="/assets/js/12.8bd1929b.js"><link rel="prefetch" href="/assets/js/120.1327c5d1.js"><link rel="prefetch" href="/assets/js/121.df650198.js"><link rel="prefetch" href="/assets/js/122.aae17f4e.js"><link rel="prefetch" href="/assets/js/123.ce82f47d.js"><link rel="prefetch" href="/assets/js/124.26b9296d.js"><link rel="prefetch" href="/assets/js/125.25341b03.js"><link rel="prefetch" href="/assets/js/126.a322ae87.js"><link rel="prefetch" href="/assets/js/127.d19d83a8.js"><link rel="prefetch" href="/assets/js/128.57397ec4.js"><link rel="prefetch" href="/assets/js/129.cddf11fb.js"><link rel="prefetch" href="/assets/js/13.89b0bee6.js"><link rel="prefetch" href="/assets/js/130.233f34dc.js"><link rel="prefetch" href="/assets/js/131.d9c82885.js"><link rel="prefetch" href="/assets/js/132.c806fc3d.js"><link rel="prefetch" href="/assets/js/133.1fb1021b.js"><link rel="prefetch" href="/assets/js/134.55127691.js"><link rel="prefetch" href="/assets/js/135.f1eceeed.js"><link rel="prefetch" href="/assets/js/136.c1560a93.js"><link rel="prefetch" href="/assets/js/137.63c49866.js"><link rel="prefetch" href="/assets/js/138.5fe32c17.js"><link rel="prefetch" href="/assets/js/139.7ed0036a.js"><link rel="prefetch" href="/assets/js/14.05030778.js"><link rel="prefetch" href="/assets/js/140.5791e121.js"><link rel="prefetch" href="/assets/js/141.51770f04.js"><link rel="prefetch" href="/assets/js/142.6fb8fd3a.js"><link rel="prefetch" href="/assets/js/143.cb474433.js"><link rel="prefetch" href="/assets/js/144.0ce90ec6.js"><link rel="prefetch" href="/assets/js/145.0a0cb1c3.js"><link rel="prefetch" href="/assets/js/146.8bbc9e3b.js"><link rel="prefetch" href="/assets/js/147.b6783918.js"><link rel="prefetch" href="/assets/js/148.40ec0811.js"><link rel="prefetch" href="/assets/js/149.dea285d2.js"><link rel="prefetch" href="/assets/js/15.efef2d1b.js"><link rel="prefetch" href="/assets/js/150.7504351a.js"><link rel="prefetch" href="/assets/js/151.25e3f6a5.js"><link rel="prefetch" href="/assets/js/152.1bc21368.js"><link rel="prefetch" href="/assets/js/153.d395af94.js"><link rel="prefetch" href="/assets/js/154.5f5d2d95.js"><link rel="prefetch" href="/assets/js/155.5bb9391c.js"><link rel="prefetch" href="/assets/js/156.787b7172.js"><link rel="prefetch" href="/assets/js/157.ceccf7ca.js"><link rel="prefetch" href="/assets/js/158.5542d68b.js"><link rel="prefetch" href="/assets/js/159.9146bf68.js"><link rel="prefetch" href="/assets/js/16.307e235e.js"><link rel="prefetch" href="/assets/js/160.66555b7c.js"><link rel="prefetch" href="/assets/js/161.e17ec2ba.js"><link rel="prefetch" href="/assets/js/162.28f8d9c6.js"><link rel="prefetch" href="/assets/js/163.d27e5402.js"><link rel="prefetch" href="/assets/js/164.2e7c87ca.js"><link rel="prefetch" href="/assets/js/165.10f6348c.js"><link rel="prefetch" href="/assets/js/166.ba22558d.js"><link rel="prefetch" href="/assets/js/167.03b2b6f1.js"><link rel="prefetch" href="/assets/js/168.95b9cd51.js"><link rel="prefetch" href="/assets/js/169.9d5abaf8.js"><link rel="prefetch" href="/assets/js/17.8e7c137e.js"><link rel="prefetch" href="/assets/js/170.a9a4a69e.js"><link rel="prefetch" href="/assets/js/171.c2d23226.js"><link rel="prefetch" href="/assets/js/172.1bd427f9.js"><link rel="prefetch" href="/assets/js/173.2c53877d.js"><link rel="prefetch" href="/assets/js/174.ec879d25.js"><link rel="prefetch" href="/assets/js/175.c32e6c4f.js"><link rel="prefetch" href="/assets/js/176.6b1d0ffa.js"><link rel="prefetch" href="/assets/js/177.5e8c5d1c.js"><link rel="prefetch" href="/assets/js/178.10be38e6.js"><link rel="prefetch" href="/assets/js/179.6724c9df.js"><link rel="prefetch" href="/assets/js/18.7fcb42c3.js"><link rel="prefetch" href="/assets/js/180.b26ed559.js"><link rel="prefetch" href="/assets/js/181.113a50d4.js"><link rel="prefetch" href="/assets/js/182.25a92d08.js"><link rel="prefetch" href="/assets/js/183.7429f323.js"><link rel="prefetch" href="/assets/js/184.e595c325.js"><link rel="prefetch" href="/assets/js/185.c973228d.js"><link rel="prefetch" href="/assets/js/186.0a647caa.js"><link rel="prefetch" href="/assets/js/187.2b1628b6.js"><link rel="prefetch" href="/assets/js/188.a88b4ad9.js"><link rel="prefetch" href="/assets/js/189.2fe1abbb.js"><link rel="prefetch" href="/assets/js/19.6dcea1bc.js"><link rel="prefetch" href="/assets/js/190.46d6460f.js"><link rel="prefetch" href="/assets/js/191.f4fb4998.js"><link rel="prefetch" href="/assets/js/192.74a4ad9f.js"><link rel="prefetch" href="/assets/js/193.91af848a.js"><link rel="prefetch" href="/assets/js/194.f9597fa6.js"><link rel="prefetch" href="/assets/js/195.6007909c.js"><link rel="prefetch" href="/assets/js/196.61f30712.js"><link rel="prefetch" href="/assets/js/197.f7096cb0.js"><link rel="prefetch" href="/assets/js/198.33d13915.js"><link rel="prefetch" href="/assets/js/199.9339c983.js"><link rel="prefetch" href="/assets/js/20.86c2c262.js"><link rel="prefetch" href="/assets/js/200.11374ebc.js"><link rel="prefetch" href="/assets/js/201.3e1fd856.js"><link rel="prefetch" href="/assets/js/202.93a8beeb.js"><link rel="prefetch" href="/assets/js/203.c0fee1fb.js"><link rel="prefetch" href="/assets/js/204.a8c0f8a1.js"><link rel="prefetch" href="/assets/js/205.7967210e.js"><link rel="prefetch" href="/assets/js/206.c4a88733.js"><link rel="prefetch" href="/assets/js/207.e4950166.js"><link rel="prefetch" href="/assets/js/208.a1176cf7.js"><link rel="prefetch" href="/assets/js/209.cd4f7baf.js"><link rel="prefetch" href="/assets/js/21.9c9a31ac.js"><link rel="prefetch" href="/assets/js/210.e43bd795.js"><link rel="prefetch" href="/assets/js/211.ddf04558.js"><link rel="prefetch" href="/assets/js/212.391ef50c.js"><link rel="prefetch" href="/assets/js/213.da32644a.js"><link rel="prefetch" href="/assets/js/214.181d708c.js"><link rel="prefetch" href="/assets/js/215.0114fbd1.js"><link rel="prefetch" href="/assets/js/216.9aab137a.js"><link rel="prefetch" href="/assets/js/217.25bf6db0.js"><link rel="prefetch" href="/assets/js/218.b0355ab3.js"><link rel="prefetch" href="/assets/js/219.87b99a27.js"><link rel="prefetch" href="/assets/js/22.5939eeb8.js"><link rel="prefetch" href="/assets/js/220.189892e3.js"><link rel="prefetch" href="/assets/js/221.1f604643.js"><link rel="prefetch" href="/assets/js/222.89415692.js"><link rel="prefetch" href="/assets/js/223.cb562c81.js"><link rel="prefetch" href="/assets/js/224.4c239cde.js"><link rel="prefetch" href="/assets/js/225.2b201379.js"><link rel="prefetch" href="/assets/js/226.ae5425fd.js"><link rel="prefetch" href="/assets/js/227.250dcdfc.js"><link rel="prefetch" href="/assets/js/228.c5e0493c.js"><link rel="prefetch" href="/assets/js/229.36b1d13d.js"><link rel="prefetch" href="/assets/js/23.9e765009.js"><link rel="prefetch" href="/assets/js/230.6e191eaf.js"><link rel="prefetch" href="/assets/js/231.c253f165.js"><link rel="prefetch" href="/assets/js/232.02191827.js"><link rel="prefetch" href="/assets/js/233.b662ceb3.js"><link rel="prefetch" href="/assets/js/234.1a3c416f.js"><link rel="prefetch" href="/assets/js/235.7e36938c.js"><link rel="prefetch" href="/assets/js/236.9c53b690.js"><link rel="prefetch" href="/assets/js/237.ea36cc85.js"><link rel="prefetch" href="/assets/js/238.b33057d4.js"><link rel="prefetch" href="/assets/js/239.0868edac.js"><link rel="prefetch" href="/assets/js/24.8e4704a7.js"><link rel="prefetch" href="/assets/js/240.2a7704ab.js"><link rel="prefetch" href="/assets/js/241.0fcb9572.js"><link rel="prefetch" href="/assets/js/242.ce7b9353.js"><link rel="prefetch" href="/assets/js/243.9f744f0b.js"><link rel="prefetch" href="/assets/js/244.a78ef66e.js"><link rel="prefetch" href="/assets/js/245.d7576519.js"><link rel="prefetch" href="/assets/js/246.ca4fd3c4.js"><link rel="prefetch" href="/assets/js/247.a44e8ce8.js"><link rel="prefetch" href="/assets/js/248.a9c1de28.js"><link rel="prefetch" href="/assets/js/249.da16a6a9.js"><link rel="prefetch" href="/assets/js/25.58ecd9b7.js"><link rel="prefetch" href="/assets/js/250.1d79bfff.js"><link rel="prefetch" href="/assets/js/251.a3e6ce2a.js"><link rel="prefetch" href="/assets/js/252.19753464.js"><link rel="prefetch" href="/assets/js/253.981b17b4.js"><link rel="prefetch" href="/assets/js/254.a8d017c7.js"><link rel="prefetch" href="/assets/js/255.49af6fcc.js"><link rel="prefetch" href="/assets/js/256.dd891671.js"><link rel="prefetch" href="/assets/js/257.4ed68d8d.js"><link rel="prefetch" href="/assets/js/258.5307d7a8.js"><link rel="prefetch" href="/assets/js/259.6ddcac1f.js"><link rel="prefetch" href="/assets/js/26.967ebdc3.js"><link rel="prefetch" href="/assets/js/260.b1c1f329.js"><link rel="prefetch" href="/assets/js/261.674d550e.js"><link rel="prefetch" href="/assets/js/262.7f75caba.js"><link rel="prefetch" href="/assets/js/263.4f76640d.js"><link rel="prefetch" href="/assets/js/264.b375613b.js"><link rel="prefetch" href="/assets/js/265.cc9c6501.js"><link rel="prefetch" href="/assets/js/266.c642e410.js"><link rel="prefetch" href="/assets/js/267.ab0de99f.js"><link rel="prefetch" href="/assets/js/268.24457362.js"><link rel="prefetch" href="/assets/js/269.2e8d42d9.js"><link rel="prefetch" href="/assets/js/27.d33e568a.js"><link rel="prefetch" href="/assets/js/270.e16d1e3a.js"><link rel="prefetch" href="/assets/js/271.77daddc8.js"><link rel="prefetch" href="/assets/js/272.7e84bdb2.js"><link rel="prefetch" href="/assets/js/273.d5dbce4e.js"><link rel="prefetch" href="/assets/js/274.6feb83b8.js"><link rel="prefetch" href="/assets/js/275.103f0486.js"><link rel="prefetch" href="/assets/js/276.2f998450.js"><link rel="prefetch" href="/assets/js/277.791a5013.js"><link rel="prefetch" href="/assets/js/278.3e0520fd.js"><link rel="prefetch" href="/assets/js/279.fcb87095.js"><link rel="prefetch" href="/assets/js/28.287f05a3.js"><link rel="prefetch" href="/assets/js/280.27106da5.js"><link rel="prefetch" href="/assets/js/281.91186cc2.js"><link rel="prefetch" href="/assets/js/282.3ac046ef.js"><link rel="prefetch" href="/assets/js/283.054707a2.js"><link rel="prefetch" href="/assets/js/284.fd7ae7bf.js"><link rel="prefetch" href="/assets/js/285.39768e4e.js"><link rel="prefetch" href="/assets/js/286.ddda020a.js"><link rel="prefetch" href="/assets/js/287.6b607282.js"><link rel="prefetch" href="/assets/js/288.10968280.js"><link rel="prefetch" href="/assets/js/289.83e85ab4.js"><link rel="prefetch" href="/assets/js/29.fe9422c1.js"><link rel="prefetch" href="/assets/js/290.ea068360.js"><link rel="prefetch" href="/assets/js/291.cecf9a33.js"><link rel="prefetch" href="/assets/js/292.76975bb4.js"><link rel="prefetch" href="/assets/js/293.a63be123.js"><link rel="prefetch" href="/assets/js/294.7f47f63d.js"><link rel="prefetch" href="/assets/js/295.8c920f6f.js"><link rel="prefetch" href="/assets/js/296.0df85a34.js"><link rel="prefetch" href="/assets/js/297.718b10bf.js"><link rel="prefetch" href="/assets/js/298.3781ec23.js"><link rel="prefetch" href="/assets/js/299.c345f6e7.js"><link rel="prefetch" href="/assets/js/3.e0c57d3e.js"><link rel="prefetch" href="/assets/js/30.ecca89f6.js"><link rel="prefetch" href="/assets/js/300.87f82f09.js"><link rel="prefetch" href="/assets/js/301.4d2f986c.js"><link rel="prefetch" href="/assets/js/302.9e65b4f7.js"><link rel="prefetch" href="/assets/js/303.a7a07667.js"><link rel="prefetch" href="/assets/js/304.fe7e8225.js"><link rel="prefetch" href="/assets/js/305.760e05cb.js"><link rel="prefetch" href="/assets/js/306.30ba2755.js"><link rel="prefetch" href="/assets/js/307.fdb5e282.js"><link rel="prefetch" href="/assets/js/308.760b43d7.js"><link rel="prefetch" href="/assets/js/309.2ad5b744.js"><link rel="prefetch" href="/assets/js/31.671ae8f6.js"><link rel="prefetch" href="/assets/js/310.5ceeda16.js"><link rel="prefetch" href="/assets/js/311.1a9c85c6.js"><link rel="prefetch" href="/assets/js/312.9ed98b62.js"><link rel="prefetch" href="/assets/js/314.c9d0b6d2.js"><link rel="prefetch" href="/assets/js/315.5c5807cb.js"><link rel="prefetch" href="/assets/js/316.40a7ffb0.js"><link rel="prefetch" href="/assets/js/317.d12e1ff6.js"><link rel="prefetch" href="/assets/js/318.e5c71f34.js"><link rel="prefetch" href="/assets/js/319.cc5e5279.js"><link rel="prefetch" href="/assets/js/32.88e43d7e.js"><link rel="prefetch" href="/assets/js/320.f18837bb.js"><link rel="prefetch" href="/assets/js/321.7969f1e2.js"><link rel="prefetch" href="/assets/js/322.74aeb82f.js"><link rel="prefetch" href="/assets/js/323.354a4de0.js"><link rel="prefetch" href="/assets/js/324.bac5b379.js"><link rel="prefetch" href="/assets/js/325.145a31ae.js"><link rel="prefetch" href="/assets/js/326.bbc46277.js"><link rel="prefetch" href="/assets/js/327.306f70db.js"><link rel="prefetch" href="/assets/js/328.1af4efed.js"><link rel="prefetch" href="/assets/js/329.15b29081.js"><link rel="prefetch" href="/assets/js/33.59c6fc69.js"><link rel="prefetch" href="/assets/js/330.a4ac66fc.js"><link rel="prefetch" href="/assets/js/331.35f0f6c3.js"><link rel="prefetch" href="/assets/js/332.e36e061d.js"><link rel="prefetch" href="/assets/js/333.08477386.js"><link rel="prefetch" href="/assets/js/334.be69b8b3.js"><link rel="prefetch" href="/assets/js/335.434734ca.js"><link rel="prefetch" href="/assets/js/336.3cbce0cd.js"><link rel="prefetch" href="/assets/js/337.82fa8d11.js"><link rel="prefetch" href="/assets/js/338.28c84ece.js"><link rel="prefetch" href="/assets/js/339.88f98613.js"><link rel="prefetch" href="/assets/js/34.0ece5672.js"><link rel="prefetch" href="/assets/js/340.25f40ebf.js"><link rel="prefetch" href="/assets/js/341.997c73c1.js"><link rel="prefetch" href="/assets/js/342.7013a957.js"><link rel="prefetch" href="/assets/js/343.65626256.js"><link rel="prefetch" href="/assets/js/344.57f2bdb4.js"><link rel="prefetch" href="/assets/js/345.38f630e9.js"><link rel="prefetch" href="/assets/js/346.9ad2fbaf.js"><link rel="prefetch" href="/assets/js/347.57091be7.js"><link rel="prefetch" href="/assets/js/348.1ab8ba98.js"><link rel="prefetch" href="/assets/js/349.6e295edd.js"><link rel="prefetch" href="/assets/js/35.2555d318.js"><link rel="prefetch" href="/assets/js/350.b30f3fbf.js"><link rel="prefetch" href="/assets/js/351.60773132.js"><link rel="prefetch" href="/assets/js/352.13db1b1d.js"><link rel="prefetch" href="/assets/js/353.171c8652.js"><link rel="prefetch" href="/assets/js/354.15ecc76b.js"><link rel="prefetch" href="/assets/js/355.9fbc80e0.js"><link rel="prefetch" href="/assets/js/356.84d2c6de.js"><link rel="prefetch" href="/assets/js/357.739df3d4.js"><link rel="prefetch" href="/assets/js/358.88560f09.js"><link rel="prefetch" href="/assets/js/359.6a0bb2b8.js"><link rel="prefetch" href="/assets/js/36.3478b3d7.js"><link rel="prefetch" href="/assets/js/360.ef8b18c6.js"><link rel="prefetch" href="/assets/js/361.db83fa7d.js"><link rel="prefetch" href="/assets/js/362.9baf3da9.js"><link rel="prefetch" href="/assets/js/363.c220f73c.js"><link rel="prefetch" href="/assets/js/364.088926b8.js"><link rel="prefetch" href="/assets/js/365.101a11ff.js"><link rel="prefetch" href="/assets/js/366.41a2bbdb.js"><link rel="prefetch" href="/assets/js/367.e7471fcd.js"><link rel="prefetch" href="/assets/js/368.efbb651a.js"><link rel="prefetch" href="/assets/js/369.8c111250.js"><link rel="prefetch" href="/assets/js/37.cf06df2c.js"><link rel="prefetch" href="/assets/js/370.d6254892.js"><link rel="prefetch" href="/assets/js/371.9bccb7f9.js"><link rel="prefetch" href="/assets/js/372.ddc12fda.js"><link rel="prefetch" href="/assets/js/373.91b3ad6b.js"><link rel="prefetch" href="/assets/js/374.c8c27965.js"><link rel="prefetch" href="/assets/js/375.26df66e7.js"><link rel="prefetch" href="/assets/js/376.8fab051f.js"><link rel="prefetch" href="/assets/js/377.7cda8366.js"><link rel="prefetch" href="/assets/js/378.b726510c.js"><link rel="prefetch" href="/assets/js/379.c66b85c0.js"><link rel="prefetch" href="/assets/js/38.afb74648.js"><link rel="prefetch" href="/assets/js/380.80b1dbaa.js"><link rel="prefetch" href="/assets/js/381.9eae4d8d.js"><link rel="prefetch" href="/assets/js/382.875628ce.js"><link rel="prefetch" href="/assets/js/383.a5154208.js"><link rel="prefetch" href="/assets/js/384.311052bf.js"><link rel="prefetch" href="/assets/js/385.bfce1e00.js"><link rel="prefetch" href="/assets/js/386.354b125a.js"><link rel="prefetch" href="/assets/js/387.7bbe1740.js"><link rel="prefetch" href="/assets/js/388.ee15d89e.js"><link rel="prefetch" href="/assets/js/389.1d2d4ccc.js"><link rel="prefetch" href="/assets/js/39.c314f21b.js"><link rel="prefetch" href="/assets/js/390.90ca40a9.js"><link rel="prefetch" href="/assets/js/391.d199796b.js"><link rel="prefetch" href="/assets/js/392.672aae85.js"><link rel="prefetch" href="/assets/js/393.3a57edae.js"><link rel="prefetch" href="/assets/js/394.b46b9242.js"><link rel="prefetch" href="/assets/js/395.77d35e16.js"><link rel="prefetch" href="/assets/js/396.677289ca.js"><link rel="prefetch" href="/assets/js/397.0cb9500f.js"><link rel="prefetch" href="/assets/js/398.962ab9a6.js"><link rel="prefetch" href="/assets/js/399.c6da0357.js"><link rel="prefetch" href="/assets/js/40.8bb0c972.js"><link rel="prefetch" href="/assets/js/400.36c0a7d6.js"><link rel="prefetch" href="/assets/js/401.9bf663ea.js"><link rel="prefetch" href="/assets/js/402.ecf01655.js"><link rel="prefetch" href="/assets/js/403.f4237c9f.js"><link rel="prefetch" href="/assets/js/404.db53111c.js"><link rel="prefetch" href="/assets/js/405.3ee804d4.js"><link rel="prefetch" href="/assets/js/406.963652f1.js"><link rel="prefetch" href="/assets/js/407.6136eb18.js"><link rel="prefetch" href="/assets/js/408.48792ff4.js"><link rel="prefetch" href="/assets/js/409.5e291789.js"><link rel="prefetch" href="/assets/js/41.e74854d6.js"><link rel="prefetch" href="/assets/js/410.442c009b.js"><link rel="prefetch" href="/assets/js/411.0c54fdb2.js"><link rel="prefetch" href="/assets/js/412.6e141134.js"><link rel="prefetch" href="/assets/js/413.2320aff0.js"><link rel="prefetch" href="/assets/js/414.05d880a9.js"><link rel="prefetch" href="/assets/js/415.32322d35.js"><link rel="prefetch" href="/assets/js/416.4fba6f60.js"><link rel="prefetch" href="/assets/js/417.1a0596ef.js"><link rel="prefetch" href="/assets/js/418.82ea5e39.js"><link rel="prefetch" href="/assets/js/419.8f90b199.js"><link rel="prefetch" href="/assets/js/42.e492c74b.js"><link rel="prefetch" href="/assets/js/420.3e817d1b.js"><link rel="prefetch" href="/assets/js/421.4f55039c.js"><link rel="prefetch" href="/assets/js/422.2bf4ed76.js"><link rel="prefetch" href="/assets/js/423.67e9b23d.js"><link rel="prefetch" href="/assets/js/424.087a8b6b.js"><link rel="prefetch" href="/assets/js/425.1e94b153.js"><link rel="prefetch" href="/assets/js/426.f0367461.js"><link rel="prefetch" href="/assets/js/427.3d28a4b2.js"><link rel="prefetch" href="/assets/js/428.ce36b8ee.js"><link rel="prefetch" href="/assets/js/429.105dc086.js"><link rel="prefetch" href="/assets/js/43.75f9f169.js"><link rel="prefetch" href="/assets/js/430.08b72517.js"><link rel="prefetch" href="/assets/js/431.208ce8d8.js"><link rel="prefetch" href="/assets/js/432.6c4fb6f0.js"><link rel="prefetch" href="/assets/js/433.1074506a.js"><link rel="prefetch" href="/assets/js/434.e5ce0f12.js"><link rel="prefetch" href="/assets/js/435.15247615.js"><link rel="prefetch" href="/assets/js/436.61555659.js"><link rel="prefetch" href="/assets/js/437.0cf79a46.js"><link rel="prefetch" href="/assets/js/438.9a5decbc.js"><link rel="prefetch" href="/assets/js/439.c66f17c5.js"><link rel="prefetch" href="/assets/js/44.8a8252fc.js"><link rel="prefetch" href="/assets/js/440.845b7492.js"><link rel="prefetch" href="/assets/js/441.602f5a22.js"><link rel="prefetch" href="/assets/js/442.1574dc38.js"><link rel="prefetch" href="/assets/js/443.cc12b13c.js"><link rel="prefetch" href="/assets/js/444.236a7fb7.js"><link rel="prefetch" href="/assets/js/445.f391fec2.js"><link rel="prefetch" href="/assets/js/446.cbd42128.js"><link rel="prefetch" href="/assets/js/447.f1045e95.js"><link rel="prefetch" href="/assets/js/448.67ce60c2.js"><link rel="prefetch" href="/assets/js/449.6b62b1ad.js"><link rel="prefetch" href="/assets/js/45.d4f0276c.js"><link rel="prefetch" href="/assets/js/450.6b6ffc4b.js"><link rel="prefetch" href="/assets/js/451.3c3e1317.js"><link rel="prefetch" href="/assets/js/452.6003d8da.js"><link rel="prefetch" href="/assets/js/453.a44d279b.js"><link rel="prefetch" href="/assets/js/454.78070189.js"><link rel="prefetch" href="/assets/js/455.f2b79088.js"><link rel="prefetch" href="/assets/js/456.91663bf5.js"><link rel="prefetch" href="/assets/js/457.35a8e118.js"><link rel="prefetch" href="/assets/js/458.4149d6b7.js"><link rel="prefetch" href="/assets/js/459.7ea1e553.js"><link rel="prefetch" href="/assets/js/46.6ddb0a09.js"><link rel="prefetch" href="/assets/js/460.3995271b.js"><link rel="prefetch" href="/assets/js/461.091f1430.js"><link rel="prefetch" href="/assets/js/462.4cd71054.js"><link rel="prefetch" href="/assets/js/463.6857db16.js"><link rel="prefetch" href="/assets/js/464.a1bda4d9.js"><link rel="prefetch" href="/assets/js/465.677688cc.js"><link rel="prefetch" href="/assets/js/466.62a2c52f.js"><link rel="prefetch" href="/assets/js/467.4aa3b11e.js"><link rel="prefetch" href="/assets/js/468.817b6b69.js"><link rel="prefetch" href="/assets/js/469.51f23dcd.js"><link rel="prefetch" href="/assets/js/47.3f31abda.js"><link rel="prefetch" href="/assets/js/470.69ea0010.js"><link rel="prefetch" href="/assets/js/471.7efe5b62.js"><link rel="prefetch" href="/assets/js/472.af7c0c2d.js"><link rel="prefetch" href="/assets/js/473.0cad2221.js"><link rel="prefetch" href="/assets/js/474.e8f9a1e9.js"><link rel="prefetch" href="/assets/js/475.b5b9b45a.js"><link rel="prefetch" href="/assets/js/476.c7a0afe6.js"><link rel="prefetch" href="/assets/js/477.2a810d6e.js"><link rel="prefetch" href="/assets/js/478.0efbc4c7.js"><link rel="prefetch" href="/assets/js/479.dd5bbccc.js"><link rel="prefetch" href="/assets/js/48.8ff4bc01.js"><link rel="prefetch" href="/assets/js/480.33e9fcec.js"><link rel="prefetch" href="/assets/js/481.60f573e7.js"><link rel="prefetch" href="/assets/js/482.7b54b4fb.js"><link rel="prefetch" href="/assets/js/483.53290792.js"><link rel="prefetch" href="/assets/js/484.bc29ab5e.js"><link rel="prefetch" href="/assets/js/485.811fd0e7.js"><link rel="prefetch" href="/assets/js/486.b6ec0cbc.js"><link rel="prefetch" href="/assets/js/487.d76ef442.js"><link rel="prefetch" href="/assets/js/488.dc438775.js"><link rel="prefetch" href="/assets/js/489.03938f88.js"><link rel="prefetch" href="/assets/js/49.d14740e5.js"><link rel="prefetch" href="/assets/js/490.87e301b9.js"><link rel="prefetch" href="/assets/js/491.ce0fd7e5.js"><link rel="prefetch" href="/assets/js/492.ab10827f.js"><link rel="prefetch" href="/assets/js/493.52442a50.js"><link rel="prefetch" href="/assets/js/494.2606c238.js"><link rel="prefetch" href="/assets/js/495.4218d96e.js"><link rel="prefetch" href="/assets/js/496.09da8fd9.js"><link rel="prefetch" href="/assets/js/497.0059402d.js"><link rel="prefetch" href="/assets/js/498.9f6cfe70.js"><link rel="prefetch" href="/assets/js/499.35e2fee2.js"><link rel="prefetch" href="/assets/js/5.7fd7e748.js"><link rel="prefetch" href="/assets/js/50.2b80f2b9.js"><link rel="prefetch" href="/assets/js/500.c1ab43b9.js"><link rel="prefetch" href="/assets/js/501.01fe1e3b.js"><link rel="prefetch" href="/assets/js/502.4373b1ae.js"><link rel="prefetch" href="/assets/js/503.2f03713d.js"><link rel="prefetch" href="/assets/js/504.80f22850.js"><link rel="prefetch" href="/assets/js/505.e0bbc99e.js"><link rel="prefetch" href="/assets/js/506.507dc313.js"><link rel="prefetch" href="/assets/js/507.fb6bad79.js"><link rel="prefetch" href="/assets/js/508.5e699aa9.js"><link rel="prefetch" href="/assets/js/509.8d16f124.js"><link rel="prefetch" href="/assets/js/51.e473d3f3.js"><link rel="prefetch" href="/assets/js/510.34c69374.js"><link rel="prefetch" href="/assets/js/511.7a3ea23f.js"><link rel="prefetch" href="/assets/js/512.444e2951.js"><link rel="prefetch" href="/assets/js/513.d270dbcc.js"><link rel="prefetch" href="/assets/js/514.1ff5debc.js"><link rel="prefetch" href="/assets/js/515.2a5036b4.js"><link rel="prefetch" href="/assets/js/516.519572fa.js"><link rel="prefetch" href="/assets/js/517.310e6a40.js"><link rel="prefetch" href="/assets/js/518.5f4c76cc.js"><link rel="prefetch" href="/assets/js/519.afd8b4ec.js"><link rel="prefetch" href="/assets/js/52.b2705e5a.js"><link rel="prefetch" href="/assets/js/520.78726749.js"><link rel="prefetch" href="/assets/js/521.14c49cc4.js"><link rel="prefetch" href="/assets/js/522.e66a26d6.js"><link rel="prefetch" href="/assets/js/523.dc9f7da0.js"><link rel="prefetch" href="/assets/js/524.d8a555ad.js"><link rel="prefetch" href="/assets/js/525.283ec81f.js"><link rel="prefetch" href="/assets/js/526.286f94bf.js"><link rel="prefetch" href="/assets/js/527.d0f5bacb.js"><link rel="prefetch" href="/assets/js/528.a147459b.js"><link rel="prefetch" href="/assets/js/529.8e2036f6.js"><link rel="prefetch" href="/assets/js/53.b22d1830.js"><link rel="prefetch" href="/assets/js/530.7e39049e.js"><link rel="prefetch" href="/assets/js/531.e674752b.js"><link rel="prefetch" href="/assets/js/532.8fe6dc9a.js"><link rel="prefetch" href="/assets/js/533.1611f6fc.js"><link rel="prefetch" href="/assets/js/534.30350526.js"><link rel="prefetch" href="/assets/js/535.c53c8062.js"><link rel="prefetch" href="/assets/js/536.194c0f54.js"><link rel="prefetch" href="/assets/js/537.9fff58be.js"><link rel="prefetch" href="/assets/js/538.5fc4dbf1.js"><link rel="prefetch" href="/assets/js/539.dcb3dbde.js"><link rel="prefetch" href="/assets/js/54.dd781fee.js"><link rel="prefetch" href="/assets/js/540.e603d37f.js"><link rel="prefetch" href="/assets/js/541.8c3509ee.js"><link rel="prefetch" href="/assets/js/542.32647773.js"><link rel="prefetch" href="/assets/js/543.6d7bcae1.js"><link rel="prefetch" href="/assets/js/544.f56f121b.js"><link rel="prefetch" href="/assets/js/545.3d29510d.js"><link rel="prefetch" href="/assets/js/546.81e647f6.js"><link rel="prefetch" href="/assets/js/547.669e6f5b.js"><link rel="prefetch" href="/assets/js/548.32996733.js"><link rel="prefetch" href="/assets/js/549.8681397c.js"><link rel="prefetch" href="/assets/js/55.4bae83d9.js"><link rel="prefetch" href="/assets/js/550.41afbfd6.js"><link rel="prefetch" href="/assets/js/551.8dc3f7b8.js"><link rel="prefetch" href="/assets/js/552.1ee0d0c6.js"><link rel="prefetch" href="/assets/js/553.dadf63ed.js"><link rel="prefetch" href="/assets/js/554.8644a9ab.js"><link rel="prefetch" href="/assets/js/555.8ec41521.js"><link rel="prefetch" href="/assets/js/556.9606b8c9.js"><link rel="prefetch" href="/assets/js/557.74ad4a9c.js"><link rel="prefetch" href="/assets/js/558.24ff45f5.js"><link rel="prefetch" href="/assets/js/559.76efed78.js"><link rel="prefetch" href="/assets/js/56.718429c0.js"><link rel="prefetch" href="/assets/js/560.2ef5cc53.js"><link rel="prefetch" href="/assets/js/561.b617f5cc.js"><link rel="prefetch" href="/assets/js/562.552e64a7.js"><link rel="prefetch" href="/assets/js/563.78b6d1ab.js"><link rel="prefetch" href="/assets/js/564.3b5dfa30.js"><link rel="prefetch" href="/assets/js/565.6433e636.js"><link rel="prefetch" href="/assets/js/566.28e8456d.js"><link rel="prefetch" href="/assets/js/567.313eee33.js"><link rel="prefetch" href="/assets/js/568.3d648b50.js"><link rel="prefetch" href="/assets/js/569.671a6298.js"><link rel="prefetch" href="/assets/js/57.c8333339.js"><link rel="prefetch" href="/assets/js/570.471719cb.js"><link rel="prefetch" href="/assets/js/571.ef881d90.js"><link rel="prefetch" href="/assets/js/572.977abd40.js"><link rel="prefetch" href="/assets/js/573.0d03433d.js"><link rel="prefetch" href="/assets/js/574.8251b547.js"><link rel="prefetch" href="/assets/js/575.171cf807.js"><link rel="prefetch" href="/assets/js/576.80b09c7e.js"><link rel="prefetch" href="/assets/js/577.1d5f24a7.js"><link rel="prefetch" href="/assets/js/578.5645f036.js"><link rel="prefetch" href="/assets/js/579.952881cd.js"><link rel="prefetch" href="/assets/js/58.b9e624cb.js"><link rel="prefetch" href="/assets/js/580.ab812d3b.js"><link rel="prefetch" href="/assets/js/581.b647a055.js"><link rel="prefetch" href="/assets/js/582.83438adb.js"><link rel="prefetch" href="/assets/js/583.b1aa2cf2.js"><link rel="prefetch" href="/assets/js/584.c2f1007a.js"><link rel="prefetch" href="/assets/js/585.45dbf748.js"><link rel="prefetch" href="/assets/js/586.4c3ffbc3.js"><link rel="prefetch" href="/assets/js/587.e71d43c3.js"><link rel="prefetch" href="/assets/js/588.fd7f9eea.js"><link rel="prefetch" href="/assets/js/589.8bf05731.js"><link rel="prefetch" href="/assets/js/59.8bf10afa.js"><link rel="prefetch" href="/assets/js/590.0e4ba5e0.js"><link rel="prefetch" href="/assets/js/591.95f0532d.js"><link rel="prefetch" href="/assets/js/592.bd7ef654.js"><link rel="prefetch" href="/assets/js/593.c7a65b3d.js"><link rel="prefetch" href="/assets/js/594.078a006a.js"><link rel="prefetch" href="/assets/js/595.d6e901df.js"><link rel="prefetch" href="/assets/js/596.d6208112.js"><link rel="prefetch" href="/assets/js/597.66a14285.js"><link rel="prefetch" href="/assets/js/598.30d544ef.js"><link rel="prefetch" href="/assets/js/599.e6a114fe.js"><link rel="prefetch" href="/assets/js/6.242ca76c.js"><link rel="prefetch" href="/assets/js/60.e6863bd6.js"><link rel="prefetch" href="/assets/js/600.62bb7a77.js"><link rel="prefetch" href="/assets/js/601.c7ebebb4.js"><link rel="prefetch" href="/assets/js/602.3756fa7e.js"><link rel="prefetch" href="/assets/js/603.da93e741.js"><link rel="prefetch" href="/assets/js/604.93a28c87.js"><link rel="prefetch" href="/assets/js/605.a12d21ca.js"><link rel="prefetch" href="/assets/js/606.23250d5d.js"><link rel="prefetch" href="/assets/js/607.0efff327.js"><link rel="prefetch" href="/assets/js/608.2c831508.js"><link rel="prefetch" href="/assets/js/609.70098de8.js"><link rel="prefetch" href="/assets/js/61.156b4de8.js"><link rel="prefetch" href="/assets/js/610.a408edf0.js"><link rel="prefetch" href="/assets/js/611.26c3a70f.js"><link rel="prefetch" href="/assets/js/612.2e1b1cd1.js"><link rel="prefetch" href="/assets/js/613.31e5b63e.js"><link rel="prefetch" href="/assets/js/614.6404ddc6.js"><link rel="prefetch" href="/assets/js/615.fbc11140.js"><link rel="prefetch" href="/assets/js/616.4579566e.js"><link rel="prefetch" href="/assets/js/617.9dd611ad.js"><link rel="prefetch" href="/assets/js/618.76fef12e.js"><link rel="prefetch" href="/assets/js/619.d8f9b353.js"><link rel="prefetch" href="/assets/js/62.73a556b6.js"><link rel="prefetch" href="/assets/js/620.2bf6c11c.js"><link rel="prefetch" href="/assets/js/621.9c732b88.js"><link rel="prefetch" href="/assets/js/622.ce177beb.js"><link rel="prefetch" href="/assets/js/623.41e320ec.js"><link rel="prefetch" href="/assets/js/624.817b3c8f.js"><link rel="prefetch" href="/assets/js/625.816b419b.js"><link rel="prefetch" href="/assets/js/626.3c14f028.js"><link rel="prefetch" href="/assets/js/627.758b56b4.js"><link rel="prefetch" href="/assets/js/628.86943080.js"><link rel="prefetch" href="/assets/js/629.6c75e55e.js"><link rel="prefetch" href="/assets/js/63.f1b1e853.js"><link rel="prefetch" href="/assets/js/630.94ca1db4.js"><link rel="prefetch" href="/assets/js/631.3b6f7de5.js"><link rel="prefetch" href="/assets/js/632.52f89764.js"><link rel="prefetch" href="/assets/js/633.75fd5193.js"><link rel="prefetch" href="/assets/js/634.622710b7.js"><link rel="prefetch" href="/assets/js/635.d50d1187.js"><link rel="prefetch" href="/assets/js/636.d341f6d6.js"><link rel="prefetch" href="/assets/js/637.c1f5d3b3.js"><link rel="prefetch" href="/assets/js/638.4fde80df.js"><link rel="prefetch" href="/assets/js/639.b8a205b8.js"><link rel="prefetch" href="/assets/js/64.793c820a.js"><link rel="prefetch" href="/assets/js/640.9a453c25.js"><link rel="prefetch" href="/assets/js/641.b4ed0d96.js"><link rel="prefetch" href="/assets/js/642.ffef1ff3.js"><link rel="prefetch" href="/assets/js/643.a7ec1541.js"><link rel="prefetch" href="/assets/js/644.05544b13.js"><link rel="prefetch" href="/assets/js/645.09b7731d.js"><link rel="prefetch" href="/assets/js/646.c109548f.js"><link rel="prefetch" href="/assets/js/647.f0596714.js"><link rel="prefetch" href="/assets/js/648.0c1b39d0.js"><link rel="prefetch" href="/assets/js/649.287e64d5.js"><link rel="prefetch" href="/assets/js/65.f37d0be7.js"><link rel="prefetch" href="/assets/js/650.9105410b.js"><link rel="prefetch" href="/assets/js/651.5f41618d.js"><link rel="prefetch" href="/assets/js/652.947536e5.js"><link rel="prefetch" href="/assets/js/653.61384c75.js"><link rel="prefetch" href="/assets/js/654.b549f13d.js"><link rel="prefetch" href="/assets/js/655.835429b6.js"><link rel="prefetch" href="/assets/js/656.387ac233.js"><link rel="prefetch" href="/assets/js/657.408c57c3.js"><link rel="prefetch" href="/assets/js/658.2b122032.js"><link rel="prefetch" href="/assets/js/659.83fe3485.js"><link rel="prefetch" href="/assets/js/66.5d717dec.js"><link rel="prefetch" href="/assets/js/660.f9b6ec32.js"><link rel="prefetch" href="/assets/js/661.d778682c.js"><link rel="prefetch" href="/assets/js/662.aaddc23e.js"><link rel="prefetch" href="/assets/js/663.37416307.js"><link rel="prefetch" href="/assets/js/664.450ee534.js"><link rel="prefetch" href="/assets/js/665.294b451e.js"><link rel="prefetch" href="/assets/js/666.bbec7c7b.js"><link rel="prefetch" href="/assets/js/667.e0a703ca.js"><link rel="prefetch" href="/assets/js/668.f7386e1c.js"><link rel="prefetch" href="/assets/js/669.40a74c7a.js"><link rel="prefetch" href="/assets/js/67.78c4b054.js"><link rel="prefetch" href="/assets/js/670.c7c79ad0.js"><link rel="prefetch" href="/assets/js/671.be2b7674.js"><link rel="prefetch" href="/assets/js/672.08b612fb.js"><link rel="prefetch" href="/assets/js/673.415ad76e.js"><link rel="prefetch" href="/assets/js/674.523d603e.js"><link rel="prefetch" href="/assets/js/675.1d5f94c1.js"><link rel="prefetch" href="/assets/js/676.bece4f17.js"><link rel="prefetch" href="/assets/js/677.e9b33833.js"><link rel="prefetch" href="/assets/js/678.c35ac3b8.js"><link rel="prefetch" href="/assets/js/68.b8df93e3.js"><link rel="prefetch" href="/assets/js/69.212ed37f.js"><link rel="prefetch" href="/assets/js/7.ec80a013.js"><link rel="prefetch" href="/assets/js/70.38b19eab.js"><link rel="prefetch" href="/assets/js/71.04f667f1.js"><link rel="prefetch" href="/assets/js/72.91bcc269.js"><link rel="prefetch" href="/assets/js/73.246d8f25.js"><link rel="prefetch" href="/assets/js/74.ac496839.js"><link rel="prefetch" href="/assets/js/75.b4d9ba62.js"><link rel="prefetch" href="/assets/js/76.a7a81728.js"><link rel="prefetch" href="/assets/js/77.d7e31e43.js"><link rel="prefetch" href="/assets/js/78.9abf5788.js"><link rel="prefetch" href="/assets/js/79.b2150d81.js"><link rel="prefetch" href="/assets/js/8.bfd1270e.js"><link rel="prefetch" href="/assets/js/80.7cb80d2a.js"><link rel="prefetch" href="/assets/js/81.674f5038.js"><link rel="prefetch" href="/assets/js/82.f8a79a9d.js"><link rel="prefetch" href="/assets/js/83.58e59d33.js"><link rel="prefetch" href="/assets/js/84.3bc64167.js"><link rel="prefetch" href="/assets/js/85.63f6b74c.js"><link rel="prefetch" href="/assets/js/86.cc62df1d.js"><link rel="prefetch" href="/assets/js/87.ffa9c597.js"><link rel="prefetch" href="/assets/js/88.71916ff0.js"><link rel="prefetch" href="/assets/js/89.1e49428d.js"><link rel="prefetch" href="/assets/js/9.b8e260e0.js"><link rel="prefetch" href="/assets/js/90.c52ee918.js"><link rel="prefetch" href="/assets/js/91.1482551a.js"><link rel="prefetch" href="/assets/js/92.cf73cb76.js"><link rel="prefetch" href="/assets/js/93.32c694d0.js"><link rel="prefetch" href="/assets/js/94.4af4cfae.js"><link rel="prefetch" href="/assets/js/95.c6340c1f.js"><link rel="prefetch" href="/assets/js/96.6d43f540.js"><link rel="prefetch" href="/assets/js/97.71873cf9.js"><link rel="prefetch" href="/assets/js/98.7cd8e6da.js"><link rel="prefetch" href="/assets/js/99.22c51c9e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a3df589e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">阿俊博客|记录一个程序员的成长历程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/post/" class="nav-link">存档</a></div><div class="nav-item"><a href="/record/" class="nav-link">历程</a></div><div class="nav-item"><a href="/golang/" class="nav-link">Go</a></div><div class="nav-item"><a href="/go-block/" class="nav-link">区块链</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">k8s</a></div><div class="nav-item"><a href="/pm/" class="nav-link">pm</a></div><div class="nav-item"><a href="/op/" class="nav-link">运维</a></div><div class="nav-item"><a href="/finance/" class="nav-link">金融</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于我</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go-learning/" class="nav-link">go-learning</a></li><li class="dropdown-item"><!----> <a href="/post/flutter-guide/" class="nav-link">flutter</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/more/leetcode/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/more/web/" class="nav-link">大前端</a></li></ul></div></div> <a href="https://github.com/ChinaArJun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/post/" class="nav-link">存档</a></div><div class="nav-item"><a href="/record/" class="nav-link">历程</a></div><div class="nav-item"><a href="/golang/" class="nav-link">Go</a></div><div class="nav-item"><a href="/go-block/" class="nav-link">区块链</a></div><div class="nav-item"><a href="/k8s/" class="nav-link">k8s</a></div><div class="nav-item"><a href="/pm/" class="nav-link">pm</a></div><div class="nav-item"><a href="/op/" class="nav-link">运维</a></div><div class="nav-item"><a href="/finance/" class="nav-link">金融</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于我</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/go-learning/" class="nav-link">go-learning</a></li><li class="dropdown-item"><!----> <a href="/post/flutter-guide/" class="nav-link">flutter</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/more/interview/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/more/leetcode/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/more/web/" class="nav-link">大前端</a></li></ul></div></div> <a href="https://github.com/ChinaArJun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div></div> <div style="padding-left:1.5rem;"><div></div></div> <!----> </aside> <!----> <!----> <main class="page"><div class="theme-default-content" style="margin-bottom:-5rem;"><div class="bar"><div class="bar-intro"><div class="text">
      阿里云优惠活动，点击链接进行购买: <a href="https://www.aliyun.com/minisite/goods?userCode=yg08nutm&share_source=copy_link">一年仅需89元即可以购买服务器~</a>。我个人服务器为2核4G配置，也更加推荐购买 <a href="https://www.aliyun.com/minisite/goods?userCode=yg08nutm&share_source=copy_link">2核4G三年799元</a> 配置的服务器。
    </div> <div class="text">
      你可以跟着我的笔记 <a href="https://blog.zhequtao.com/op/">当我有一台服务器时，我做了什么</a> 来开始维护服务器并搭建应用，将引导你使用 docker 和 k8s 搭建一个自己的服务器开发集群。
    </div></div></div> <!----></div> <div class="theme-default-content content__default"><p>在 <code>runtime.main()</code> 函数中，执行 <code>runtime_init()</code> 前，会启动一个 sysmon 的监控线程，执行后台监控任务：</p> <div class="language-golang extra-class"><pre class="language-text"><code>systemstack(func() {
	// 创建监控线程，该线程独立于调度器，不需要跟 p 关联即可运行
	newm(sysmon, nil)
})
</code></pre></div><p><code>sysmon</code> 函数不依赖 P 直接执行，通过 newm 函数创建一个工作线程：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func newm(fn func(), _p_ *p) {
	// 创建 m 对象
	mp := allocm(_p_, fn)
	// 暂存 m
	mp.nextp.set(_p_)
	mp.sigmask = initSigmask
	
	// ……………………
	
	execLock.rlock() // Prevent process clone.
	// 创建系统线程
	newosproc(mp, unsafe.Pointer(mp.g0.stack.hi))
	execLock.runlock()
}
</code></pre></div><p>先调用 <code>allocm</code> 在堆上创建一个 m，接着调用 <code>newosproc</code> 函数启动一个工作线程：</p> <div class="language-golang extra-class"><pre class="language-text"><code>// src/runtime/os_linux.go
//go:nowritebarrier
func newosproc(mp *m, stk unsafe.Pointer) {
	// ……………………

	ret := clone(cloneFlags, stk, unsafe.Pointer(mp), unsafe.Pointer(mp.g0), unsafe.Pointer(funcPC(mstart)))

	// ……………………
}
</code></pre></div><p>核心就是调用 clone 函数创建系统线程，新线程从 mstart 函数开始执行。<code>clone</code> 函数由汇编语言实现：</p> <div class="language-golang extra-class"><pre class="language-text"><code>// int32 clone(int32 flags, void *stk, M *mp, G *gp, void (*fn)(void));
TEXT runtime·clone(SB),NOSPLIT,$0
    // 准备系统调用的参数
    MOVL	flags+0(FP), DI
    MOVQ	stk+8(FP), SI
    MOVQ	$0, DX
	MOVQ	$0, R10

	// 将 mp，gp，fn 拷贝到寄存器，对子线程可见
	MOVQ	mp+16(FP), R8
	MOVQ	gp+24(FP), R9
	MOVQ	fn+32(FP), R12

    // 系统调用 clone
	MOVL	$56, AX
	SYSCALL

	// In parent, return.
	CMPQ	AX, $0
	JEQ	3(PC)
	// 父线程，返回
	MOVL	AX, ret+40(FP)
	RET

	// In child, on new stack.
	// 在子线程中。设置 CPU 栈顶寄存器指向子线程的栈顶
	MOVQ	SI, SP

	// If g or m are nil, skip Go-related setup.
	CMPQ	R8, $0    // m
    JEQ	nog
    CMPQ	R9, $0    // g
	JEQ	nog

	// Initialize m-&gt;procid to Linux tid
	// 通过 gettid 系统调用获取线程 ID（tid）
	MOVL	$186, AX	// gettid
	SYSCALL
	// 设置 m.procid = tid
	MOVQ	AX, m_procid(R8)

	// Set FS to point at m-&gt;tls.
	// 新线程刚刚创建出来，还未设置线程本地存储，即 m 结构体对象还未与工作线程关联起来，
    // 下面的指令负责设置新线程的 TLS，把 m 对象和工作线程关联起来
	LEAQ	m_tls(R8), DI
	CALL	runtime·settls(SB)

	// In child, set up new stack
	get_tls(CX)
	MOVQ	R8, g_m(R9) // g.m = m
	MOVQ	R9, g(CX) // tls.g = &amp;m.g0
	CALL	runtime·stackcheck(SB)

nog:
	// Call fn
	// 调用 mstart 函数。永不返回
	CALL	R12

	// It shouldn't return. If it does, exit that thread.
	MOVL	$111, DI
    MOVL	$60, AX
	SYSCALL
	JMP	-3(PC)	// keep exiting
</code></pre></div><p>先是为 clone 系统调用准备参数，参数通过寄存器传递。第一个参数指定内核创建线程时的选项，第二个参数指定新线程应该使用的栈，这两个参数都是通过 newosproc 函数传递进来的。</p> <p>接着将 m, g0, fn 分别保存到寄存器中，待子线程创建好后再拿出来使用。因为这些参数此时是在父线程的栈上，若不保存到寄存器中，子线程就取不出来了。</p> <blockquote><p>这个几个参数保存在父线程的寄存器中，创建子线程时，操作系统内核会把父线程所有的寄存器帮我们复制一份给子线程，所以当子线程开始运行时就能拿到父线程保存在寄存器中的值，从而拿到这几个参数。</p></blockquote> <p>之后，调用 clone 系统调用，内核帮我们创建出了一个子线程。相当于原来的一个执行分支现在变成了两个执行分支，于是会有两个返回。这和著名的 fork 系统调用类似，根据返回值来判断现在是处于父线程还是子线程。</p> <p>如果是父线程，就直接返回了。如果是子线程，接着还要执行一堆操作，例如设置 tls，设置 m.procid 等等。</p> <p>最后执行 mstart 函数，这是在 newosproc 函数传递进来的。<code>mstart</code> 函数再调用 <code>mstart1</code>，在 <code>mstart1</code> 里会执行这一行：</p> <div class="language-golang extra-class"><pre class="language-text"><code>// 执行启动函数。初始化过程中，fn == nil
if fn := _g_.m.mstartfn; fn != nil {
	fn()
}
</code></pre></div><p>之前我们在讲初始化的时候，这里的 fn 是空，会跳过的。但在这里，fn 就是最开始在 <code>runtime.main</code> 里设置的 <code>sysmon</code> 函数，因此这里会执行 <code>sysmon</code>，而它又是一个无限循环，永不返回。</p> <p>所以，这里不会执行到 mstart1 函数后面的 schedule 函数，也就不会进入 schedule 循环。因此这是一个不用和 p 结合的 m，它直接在后台执行，默默地执行监控任务。</p> <p>接下来，我们就来看 <code>sysmon</code> 函数到底做了什么？</p> <blockquote><p><code>sysmon</code> 执行一个无限循环，一开始每次循环休眠 20us，之后（1 ms 后）每次休眠时间倍增，最终每一轮都会休眠 10ms。</p></blockquote> <blockquote><p><code>sysmon</code> 中会进行 netpool（获取 fd 事件）、retake（抢占）、forcegc（按时间强制执行 gc），scavenge heap（释放自由列表中多余的项减少内存占用）等处理。</p></blockquote> <p>和调度相关的，我们只关心 retake 函数：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func retake(now int64) uint32 {
	n := 0
	// 遍历所有的 p
	for i := int32(0); i &lt; gomaxprocs; i++ {
		_p_ := allp[i]
		if _p_ == nil {
			continue
		}
		// 用于 sysmon 线程记录被监控 p 的系统调用时间和运行时间
		pd := &amp;_p_.sysmontick
		// p 的状态
		s := _p_.status
		if s == _Psyscall {
			// P 处于系统调用之中，需要检查是否需要抢占
			// Retake P from syscall if it's there for more than 1 sysmon tick (at least 20us).
			// _p_.syscalltick 用于记录系统调用的次数，在完成系统调用之后加 1
			t := int64(_p_.syscalltick)
			if int64(pd.syscalltick) != t {
				// pd.syscalltick != _p_.syscalltick，说明已经不是上次观察到的系统调用了，
				// 而是另外一次系统调用，所以需要重新记录 tick 和 when 值
				pd.syscalltick = uint32(t)
				pd.syscallwhen = now
				continue
			}
	
			// 只要满足下面三个条件中的任意一个，则抢占该 p，否则不抢占
			// 1. p 的运行队列里面有等待运行的 goroutine
			// 2. 没有无所事事的 p
			// 3. 从上一次监控线程观察到 p 对应的 m 处于系统调用之中到现在已经超过 10 毫秒
			if runqempty(_p_) &amp;&amp; atomic.Load(&amp;sched.nmspinning)+atomic.Load(&amp;sched.npidle) &gt; 0 &amp;&amp; pd.syscallwhen+10*1000*1000 &gt; now {
				continue
			}
			
			incidlelocked(-1)
			if atomic.Cas(&amp;_p_.status, s, _Pidle) {
				// ……………………
				n++
				_p_.syscalltick++
				// 寻找一新的 m 接管 p
				handoffp(_p_)
			}
			incidlelocked(1)
		} else if s == _Prunning {
			// P 处于运行状态，检查是否运行得太久了
			// Preempt G if it's running for too long.
			// 每发生一次调度，调度器 ++ 该值
			t := int64(_p_.schedtick)
			if int64(pd.schedtick) != t {
				pd.schedtick = uint32(t)
				pd.schedwhen = now
				continue
			}
			//pd.schedtick == t 说明(pd.schedwhen ～ now)这段时间未发生过调度
			// 这段时间是同一个goroutine一直在运行，检查是否连续运行超过了 10 毫秒
			if pd.schedwhen+forcePreemptNS &gt; now {
				continue
			}
			// 连续运行超过 10 毫秒了，发起抢占请求
			preemptone(_p_)
		}
	}
	return uint32(n)
}
</code></pre></div><p>从代码来看，主要会对处于 <code>_Psyscall</code> 和 <code>_Prunning</code> 状态的 p 进行抢占。</p> <h1 id="抢占进行系统调用的-p"><a href="#抢占进行系统调用的-p" class="header-anchor">#</a> 抢占进行系统调用的 P</h1> <p>当 P 处于 <code>_Psyscall</code> 状态时，表明对应的 goroutine 正在进行系统调用。如果抢占 p，需要满足几个条件：</p> <ol><li><p>p 的本地运行队列里面有等待运行的 goroutine。这时 p 绑定的 g 正在进行系统调用，无法去执行其他的 g，因此需要接管 p 来执行其他的 g。</p></li> <li><p>没有“无所事事”的 p。<code>sched.nmspinning</code> 和 <code>sched.npidle</code> 都为 0，这就意味着没有“找工作”的 m，也没有空闲的 p，大家都在“忙”，可能有很多工作要做。因此要抢占当前的 p，让它来承担一部分工作。</p></li> <li><p>从上一次监控线程观察到 p 对应的 m 处于系统调用之中到现在已经超过 10 毫秒。这说明系统调用所花费的时间较长，需要对其进行抢占，以此来使得 <code>retake</code> 函数返回值不为 0，这样，会保持 sysmon 线程 20 us 的检查周期，提高 sysmon 监控的实时性。</p></li></ol> <p>注意，原代码是用的三个与条件，三者都要满足才会执行下面的 continue，也就是不进行抢占。因此要想进行抢占的话，只需要三个条件有一个不满足就行了。于是就有了上述三种情况。</p> <p>确定要抢占当前 p 后，先使用原子操作将 p 的状态修改为 <code>_Pidle</code>，最后调用 <code>handoffp</code> 进行抢占。</p> <div class="language-golang extra-class"><pre class="language-text"><code>func handoffp(_p_ *p) {
	// 如果 p 本地有工作或者全局有工作，需要绑定一个 m
	if !runqempty(_p_) || sched.runqsize != 0 {
		startm(_p_, false)
		return
	}

	// ……………………

	// 所有其它 p 都在运行 goroutine，说明系统比较忙，需要启动 m
	if atomic.Load(&amp;sched.nmspinning)+atomic.Load(&amp;sched.npidle) == 0 &amp;&amp; atomic.Cas(&amp;sched.nmspinning, 0, 1) { // TODO: fast atomic
		// p 没有本地工作，启动一个自旋 m 来找工作
		startm(_p_, true)
		return
	}
	lock(&amp;sched.lock)

	// ……………………

	// 全局队列有工作
	if sched.runqsize != 0 {
		unlock(&amp;sched.lock)
		startm(_p_, false)
		return
	}

	// ……………………

	// 没有工作要处理，把 p 放入全局空闲队列
	pidleput(_p_)
	unlock(&amp;sched.lock)
}
</code></pre></div><p><code>handoffp</code> 再次进行场景判断，以调用 <code>startm</code> 启动一个工作线程来绑定 p，使得整体工作继续推进。</p> <p>当 p 的本地运行队列或全局运行队列里面有待运行的 goroutine，说明还有很多工作要做，调用 <code>startm(_p_, false)</code> 启动一个 m 来结合 p，继续工作。</p> <p>当除了当前的 p 外，其他所有的 p 都在运行 goroutine，说明天下太平，每个人都有自己的事做，唯独自己没有。为了全局更快地完成工作，需要启动一个 m，且要使得 m 处于自旋状态，和 p 结合之后，尽快找到工作。</p> <p>最后，如果实在没有工作要处理，就将 p 放入全局空闲队列里。</p> <p>我们接着来看 <code>startm</code> 函数都做了些什么：</p> <div class="language-golang extra-class"><pre class="language-text"><code>// runtime/proc.go
// 
// 调用 m 来绑定 p，如果没有 m，那就新建一个
// 如果 p 为空，那就尝试获取一个处于空闲状态的 p，如果找到 p，那就什么都不做
func startm(_p_ *p, spinning bool) {
	lock(&amp;sched.lock)
	if _p_ == nil {
		// 没有指定 p 则需要从全局空闲队列中获取一个 p
		_p_ = pidleget()
		if _p_ == nil {
			unlock(&amp;sched.lock)
			if spinning {
				// 如果找到 p，放弃。还原全局处于自旋状态的 m 的数量
				if int32(atomic.Xadd(&amp;sched.nmspinning, -1)) &lt; 0 {
					throw(&quot;startm: negative nmspinning&quot;)
				}
			}
			// 没有空闲的 p，直接返回
			return
		}
	}

	// 从 m 空闲队列中获取正处于睡眠之中的工作线程，
	// 所有处于睡眠状态的 m 都在此队列中
	mp := mget()
	unlock(&amp;sched.lock)
	if mp == nil {
		// 如果没有找到 m
		var fn func()
		if spinning {
			// The caller incremented nmspinning, so set m.spinning in the new M.
			fn = mspinning
		}
		// 创建新的工作线程
		newm(fn, _p_)
		return
	}
	if mp.spinning {
		throw(&quot;startm: m is spinning&quot;)
	}
	if mp.nextp != 0 {
		throw(&quot;startm: m has p&quot;)
	}
	if spinning &amp;&amp; !runqempty(_p_) {
		throw(&quot;startm: p has runnable gs&quot;)
	}
	// The caller incremented nmspinning, so set m.spinning in the new M.
	mp.spinning = spinning
	// 设置 m 马上要结合的 p
	mp.nextp.set(_p_)
	// 唤醒 m
	notewakeup(&amp;mp.park)
}
</code></pre></div><p>首先处理 p 为空的情况，直接从全局空闲 p 队列里找，如果没找到，则直接返回。如果设置了 spinning 为 true 的话，还需要还原全局的处于自旋状态的 m 的数值：<code>&amp;sched.nmspinning</code> 。</p> <p>搞定了 p，接下来看 m。先调用 <code>mget</code> 函数从全局空闲的 m 队列里获取一个 m，如果没找到 m，则要调用 newm 新创建一个 m，并且如果设置了 spinning 为 true 的话，先要设置好 mstartfn：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func mspinning() {
	// startm's caller incremented nmspinning. Set the new M's spinning.
	getg().m.spinning = true
}
</code></pre></div><p>这样，启动 m 后，在 mstart1 函数里，进入 schedule 循环前，执行 mstartfn 函数，使得 m 处于自旋状态。</p> <p>接下来是正常情况下（找到了 p 和 m）的处理：</p> <div class="language-golang extra-class"><pre class="language-text"><code>mp.spinning = spinning
// 设置 m 马上要结合的 p
mp.nextp.set(_p_)
// 唤醒 m
notewakeup(&amp;mp.park)
</code></pre></div><p>设置 nextp 为找到的 p，调用 <code>notewakeup</code> 唤醒 m。之前我们讲 findrunnable 函数的时候，对于最后没有找到工作的 m，我们调用 <code>notesleep(&amp;_g_.m.park)</code>，使得 m 进入睡眠状态。现在终于有工作了，需要老将出山，将其唤醒：</p> <div class="language-golang extra-class"><pre class="language-text"><code>// src/runtime/lock_futex.go
func notewakeup(n *note) {
	// 设置 n.key = 1, 被唤醒的线程通过查看该值是否等于 1 
	// 来确定是被其它线程唤醒还是意外从睡眠中苏醒
	old := atomic.Xchg(key32(&amp;n.key), 1)
	if old != 0 {
		print(&quot;notewakeup - double wakeup (&quot;, old, &quot;)\n&quot;)
		throw(&quot;notewakeup - double wakeup&quot;)
	}
	futexwakeup(key32(&amp;n.key), 1)
}
</code></pre></div><blockquote><p><code>notewakeup</code> 函数首先使用 <code>atomic.Xchg</code> 设置 <code>note.key</code> 值为 1，这是为了使被唤醒的线程可以通过查看该值是否等于 1 来确定是被其它线程唤醒还是意外从睡眠中苏醒了过来。</p></blockquote> <blockquote><p>如果该值为 1 则表示是被唤醒的，可以继续工作，但如果该值为 0 则表示是意外苏醒，需要再次进入睡眠。</p></blockquote> <p>调用 <code>futexwakeup</code> 来唤醒工作线程，它和 <code>futexsleep</code> 是相对的。</p> <div class="language-golang extra-class"><pre class="language-text"><code>func futexwakeup(addr *uint32, cnt uint32) {
	// 调用 futex 函数唤醒工作线程
	ret := futex(unsafe.Pointer(addr), _FUTEX_WAKE, cnt, nil, nil, 0)
	if ret &gt;= 0 {
		return
	}
	
    // ……………………
    
}
</code></pre></div><p><code>futex</code> 由汇编语言实现，前面已经分析过，这里就不重复了。主要内容就是先准备好参数，然后进行系统调用，由内核唤醒线程。</p> <blockquote><p>内核在完成唤醒工作之后当前工作线程从内核返回到 futex 函数继续执行 SYSCALL 指令之后的代码并按函数调用链原路返回，继续执行其它代码。</p></blockquote> <blockquote><p>而被唤醒的工作线程则由内核负责在适当的时候调度到 CPU 上运行。</p></blockquote> <h1 id="抢占长时间运行的-p"><a href="#抢占长时间运行的-p" class="header-anchor">#</a> 抢占长时间运行的 P</h1> <p>我们知道，Go scheduler 采用的是一种称为协作式的抢占式调度，就是说并不强制调度，大家保持协作关系，互相信任。对于长时间运行的 P，或者说绑定在 P 上的长时间运行的 goroutine，sysmon 会检测到这种情况，然后设置一些标志，表示 goroutine 自己让出 CPU 的执行权，给其他 goroutine 一些机会。</p> <p>接下来我们就来分析当 P 处于 <code>_Prunning</code> 状态的情况。<code>sysmon</code> 扫描每个 p 时，都会记录下当前调度器调度的次数和当前时间，数据记录在结构体：</p> <div class="language-golang extra-class"><pre class="language-text"><code>type sysmontick struct {
	schedtick   uint32
	schedwhen   int64
	syscalltick uint32
	syscallwhen int64
}
</code></pre></div><p>前面两个字段记录调度器调度的次数和时间，后面两个字段记录系统调用的次数和时间。</p> <p>在下一次扫描时，对比 sysmon 记录下的 p 的调度次数和时间，与当前 p 自己记录下的调度次数和时间对比，如果一致。说明 P 在这一段时间内一直在运行同一个 goroutine。那就来计算一下运行时间是否太长了。</p> <p>如果发现运行时间超过了 10 ms，则要调用 <code>preemptone(_p_)</code> 发起抢占的请求：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func preemptone(_p_ *p) bool {
	mp := _p_.m.ptr()
	if mp == nil || mp == getg().m {
		return false
	}
	// 被抢占的 goroutine
	gp := mp.curg
	if gp == nil || gp == mp.g0 {
		return false
	}

	// 设置抢占标志
	gp.preempt = true

	// 在 goroutine 内部的每次调用都会比较栈顶指针和 g.stackguard0，
	// 来判断是否发生了栈溢出。stackPreempt 非常大的一个数，比任何栈都大
	// stackPreempt = 0xfffffade
	gp.stackguard0 = stackPreempt
	return true
}
</code></pre></div><p>基本上只是将 stackguard0 设置了一个很大的值，而检查 stackguard0 的地方在函数调用前的一段汇编代码里进行。</p> <p>举一个简单的例子：</p> <div class="language-golang extra-class"><pre class="language-text"><code>package main

import &quot;fmt&quot;

func main() {
	fmt.Println(&quot;hello qcrao.com!&quot;)
}
</code></pre></div><p>执行命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>go tool compile -S main.go
</code></pre></div><p>得到汇编代码：</p> <div class="language-asm extra-class"><pre class="language-text"><code>&quot;&quot;.main STEXT size=120 args=0x0 locals=0x48
	0x0000 00000 (test26.go:5)	TEXT	&quot;&quot;.main(SB), $72-0
    0x0000 00000 (test26.go:5)	MOVQ	(TLS), CX
    0x0009 00009 (test26.go:5)	CMPQ	SP, 16(CX)
    0x000d 00013 (test26.go:5)	JLS	113
    0x000f 00015 (test26.go:5)	SUBQ	$72, SP
	0x0013 00019 (test26.go:5)	MOVQ	BP, 64(SP)
	0x0018 00024 (test26.go:5)	LEAQ	64(SP), BP
    0x001d 00029 (test26.go:5)	FUNCDATA	$0, gclocals·69c1753bd5f81501d95132d08af04464(SB)
    0x001d 00029 (test26.go:5)	FUNCDATA	$1, gclocals·e226d4ae4a7cad8835311c6a4683c14f(SB)
	0x001d 00029 (test26.go:6)	MOVQ	$0, &quot;&quot;..autotmp_0+48(SP)
    0x0026 00038 (test26.go:6)	MOVQ	$0, &quot;&quot;..autotmp_0+56(SP)
	0x002f 00047 (test26.go:6)	LEAQ	type.string(SB), AX
	0x0036 00054 (test26.go:6)	MOVQ	AX, &quot;&quot;..autotmp_0+48(SP)
	0x003b 00059 (test26.go:6)	LEAQ	&quot;&quot;.statictmp_0(SB), AX
	0x0042 00066 (test26.go:6)	MOVQ	AX, &quot;&quot;..autotmp_0+56(SP)
	0x0047 00071 (test26.go:6)	LEAQ	&quot;&quot;..autotmp_0+48(SP), AX
	0x004c 00076 (test26.go:6)	MOVQ	AX, (SP)
	0x0050 00080 (test26.go:6)	MOVQ	$1, 8(SP)
    0x0059 00089 (test26.go:6)	MOVQ	$1, 16(SP)
	0x0062 00098 (test26.go:6)	PCDATA	$0, $1
	0x0062 00098 (test26.go:6)	CALL	fmt.Println(SB)
	0x0067 00103 (test26.go:7)	MOVQ	64(SP), BP
	0x006c 00108 (test26.go:7)	ADDQ	$72, SP
    0x0070 00112 (test26.go:7)	RET
    0x0071 00113 (test26.go:7)	NOP
    0x0071 00113 (test26.go:5)	PCDATA	$0, $-1
	0x0071 00113 (test26.go:5)	CALL	runtime.morestack_noctxt(SB)
	0x0076 00118 (test26.go:5)	JMP	0
</code></pre></div><p>以前看这段代码的时候会直接跳过前面的几行代码，看不懂。这次能看懂了！所以，那些暂时看不懂的，先放一放，没关系，让子弹飞一会儿，很多东西回过头再来看就会豁然开朗，这就是一个很好的例子。</p> <div class="language-asm extra-class"><pre class="language-text"><code>0x0000 00000 (test26.go:5)	MOVQ	(TLS), CX
</code></pre></div><p>将本地存储 tls 保存到 CX 寄存器中，（TLS）表示它所关联的 g，这里就是前面所讲到的 main gouroutine。</p> <div class="language-asm extra-class"><pre class="language-text"><code>0x0009 00009 (test26.go:5)	CMPQ	SP, 16(CX)
</code></pre></div><p>比较 SP 寄存器（代表当前 main goroutine 的栈顶寄存器）和 16(CX)，我们看下 g 结构体：</p> <div class="language-golang extra-class"><pre class="language-text"><code>type g struct {
	// goroutine 使用的栈
	stack       stack   // offset known to runtime/cgo
	// 用于栈的扩张和收缩检查
	stackguard0 uintptr // offset known to liblink
	// ……………………
}
</code></pre></div><p>对象 g 的第一个字段是 stack 结构体：</p> <div class="language-golang extra-class"><pre class="language-text"><code>type stack struct {
	lo uintptr
	hi uintptr
}
</code></pre></div><p>共 16 字节。而 <code>16(CX)</code> 表示 g 对象的第 16 个字节，跳过了 g 的第一个字段，也就是 <code>g.stackguard0</code> 字段。</p> <p>如果 SP 小于 g.stackguard0，这是必然的，因为前面已经把 g.stackguard0 设置成了一个非常大的值，因此跳转到了 113 行。</p> <div class="language-asm extra-class"><pre class="language-text"><code>0x0071 00113 (test26.go:7)	NOP
0x0071 00113 (test26.go:5)	PCDATA	$0, $-1
0x0071 00113 (test26.go:5)	CALL	runtime.morestack_noctxt(SB)
0x0076 00118 (test26.go:5)	JMP	0
</code></pre></div><p>调用 <code>runtime.morestack_noctxt</code> 函数：</p> <div class="language-asm extra-class"><pre class="language-text"><code>// src/runtime/asm_amd64.s
TEXT runtime·morestack_noctxt(SB),NOSPLIT,$0
	MOVL	$0, DX
	JMP	runtime·morestack(SB)
</code></pre></div><p>直接跳转到 <code>morestack</code> 函数：</p> <div class="language-asm extra-class"><pre class="language-text"><code>TEXT runtime·morestack(SB),NOSPLIT,$0-0
    // Cannot grow scheduler stack (m-&gt;g0).
    get_tls(CX)
    // BX = g，g 表示 main goroutine
    MOVQ	g(CX), BX
    // BX = g.m
    MOVQ	g_m(BX), BX
    // SI = g.m.g0
    MOVQ	m_g0(BX), SI
    CMPQ	g(CX), SI
    JNE	3(PC)
    CALL	runtime·badmorestackg0(SB)
    INT	$3

	// ……………………

	// Set g-&gt;sched to context in f.
	// 将函数的返回地址保存到 AX 寄存器
	MOVQ	0(SP), AX // f's PC
	// 将函数的返回地址保存到 g.sched.pc
	MOVQ	AX, (g_sched+gobuf_pc)(SI)
	// g.sched.g = g
	MOVQ	SI, (g_sched+gobuf_g)(SI)
	// 取地址操作符，调用 morestack_noctxt 之前的 rsp
	LEAQ	8(SP), AX // f's SP
	// 将 main 函数的栈顶地址保存到 g.sched.sp
	MOVQ	AX, (g_sched+gobuf_sp)(SI)
	// 将 BP 寄存器保存到 g.sched.bp
	MOVQ	BP, (g_sched+gobuf_bp)(SI)
	// newstack will fill gobuf.ctxt.

	// Call newstack on m-&gt;g0's stack.
	// BX = g.m.g0
	MOVQ	m_g0(BX), BX
	// 将 g0 保存到本地存储 tls
	MOVQ	BX, g(CX)
	// 把 g0 栈的栈顶寄存器的值恢复到 CPU 的寄存器 SP，达到切换栈的目的，下面这一条指令执行之前，
    // CPU 还是使用的调用此函数的 g 的栈，执行之后 CPU 就开始使用 g0 的栈了
	MOVQ	(g_sched+gobuf_sp)(BX), SP
	// 准备参数
	PUSHQ	DX	// ctxt argument
	// 不返回
	CALL	runtime·newstack(SB)
	MOVQ	$0, 0x1003	// crash if newstack returns
	POPQ	DX	// keep balance check happy
	RET
</code></pre></div><p>主要做的工作就是将当前 goroutine，也就是 main goroutine 的和调度相关的信息保存到 g.sched 中，以便在调度到它执行时，可以恢复。</p> <p>最后，将 g0 的地址保存到 tls 本地存储，并且切到 g0 栈执行之后的代码。继续调用 newstack 函数：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func newstack(ctxt unsafe.Pointer) {
	// thisg = g0
	thisg := getg()
	
	// ……………………

	// gp = main goroutine
	gp := thisg.m.curg
	// Write ctxt to gp.sched. We do this here instead of in
	// morestack so it has the necessary write barrier.
	gp.sched.ctxt = ctxt

	// ……………………

	morebuf := thisg.m.morebuf
	thisg.m.morebuf.pc = 0
	thisg.m.morebuf.lr = 0
	thisg.m.morebuf.sp = 0
	thisg.m.morebuf.g = 0

	// 检查 g.stackguard0 是否被设置成抢占标志
	preempt := atomic.Loaduintptr(&amp;gp.stackguard0) == stackPreempt

	if preempt {
		if thisg.m.locks != 0 || thisg.m.mallocing != 0 || thisg.m.preemptoff != &quot;&quot; || thisg.m.p.ptr().status != _Prunning {
			// 还原 stackguard0 为正常值，表示我们已经处理过抢占请求了
			gp.stackguard0 = gp.stack.lo + _StackGuard
			// 不抢占，调用 gogo 继续运行当前这个 g，不需要调用 schedule 函数去挑选另一个 goroutine
			gogo(&amp;gp.sched) // never return
		}
	}

	// ……………………

	if preempt {
		if gp == thisg.m.g0 {
			throw(&quot;runtime: preempt g0&quot;)
		}
		if thisg.m.p == 0 &amp;&amp; thisg.m.locks == 0 {
			throw(&quot;runtime: g is running but p is not&quot;)
		}
		// Synchronize with scang.
		casgstatus(gp, _Grunning, _Gwaiting)

		// ……………………

		// Act like goroutine called runtime.Gosched.
		// 修改为 running，调度起来运行
		casgstatus(gp, _Gwaiting, _Grunning)
		// 调用 gopreempt_m 把 gp 切换出去
		gopreempt_m(gp) // never return
	}

	// ……………………
}
</code></pre></div><p>去掉了很多暂时还看不懂的地方，留到后面再研究。只关注有关抢占相关的。第一次判断 preempt 标志是 true 时，检查了 g 的状态，发现不能抢占，例如它所绑定的 P 的状态不是 <code>_Prunning</code>，那就恢复它的 stackguard0 字段，下次就不会走这一套流程了。然后，调用 <code>gogo(&amp;gp.sched)</code> 继续执行当前的 goroutine。</p> <p>中间又处理了很多判断流程，再次判断 preempt 标志是 true 时，调用 <code>gopreempt_m(gp)</code> 将 gp 切换出去。</p> <div class="language-golang extra-class"><pre class="language-text"><code>func gopreempt_m(gp *g) {
	if trace.enabled {
		traceGoPreempt()
	}
	goschedImpl(gp)
}
</code></pre></div><p>最终调用 <code>goschedImpl</code> 函数：</p> <div class="language-golang extra-class"><pre class="language-text"><code>func goschedImpl(gp *g) {
	status := readgstatus(gp)
	if status&amp;^_Gscan != _Grunning {
		dumpgstatus(gp)
		throw(&quot;bad g status&quot;)
	}
	// 更改 gp 的状态
	casgstatus(gp, _Grunning, _Grunnable)
	// 解除 m 和 g 的关系
	dropg()
	lock(&amp;sched.lock)
	// 将 gp 放入全局可运行队列
	globrunqput(gp)
	unlock(&amp;sched.lock)

	// 进入新一轮的调度循环
	schedule()
}
</code></pre></div><p>将 gp 的状态改为 <code>_Grunnable</code>，放入全局可运行队列，等待下次有 m 来全局队列找工作时才能继续运行，毕竟你已经运行这么长时间了，给别人一点机会嘛。</p> <p>最后，调用 <code>schedule()</code> 函数进入新一轮的调度循环，会找出一个 goroutine 来运行，永不返回。</p> <p>这样，关于 sysmon 线程在关于调度这块到底做了啥，我们已经回答完了。总结一下：</p> <ol><li>抢占处于系统调用的 P，让其他 m 接管它，以运行其他的 goroutine。</li> <li>将运行时间过长的 goroutine 调度出去，给其他 goroutine 运行的机会。</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">7/20/2020, 2:09:44 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9ea962d1.js" defer></script><script src="/assets/js/2.c9a70b15.js" defer></script><script src="/assets/js/4.844b86fa.js" defer></script><script src="/assets/js/313.6d0015fd.js" defer></script>
  </body>
</html>
